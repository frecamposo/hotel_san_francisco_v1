{% extends "base.html" %}
{% load static %}
{% block contenido %}

      <div class="container-xxl py-5">
        <div class="container">
          <div class="row g-5">
            <div class="col-lg-8">
              <div
                id="room-carousel"
                class="carousel slide mb-5 wow fadeIn"
                data-bs-ride="carousel"
                data-wow-delay="0.1s"
              >
                <div class="carousel-inner">
                  <div class="carousel-item active">
                    <img class="w-100" src="{{habitacion.imagen.url}}" alt="Image" />
                  </div>
                  {% for f in fotos %}                
                  <div class="carousel-item">
                    <img class="w-100" src="{{f.foto.url}}" alt="Image" />
                  </div>
                  {% endfor %}
                </div>
                <button
                  class="carousel-control-prev"
                  type="button"
                  data-bs-target="#room-carousel"
                  data-bs-slide="prev"
                >
                  <span
                    class="carousel-control-prev-icon"
                    aria-hidden="true"
                  ></span>
                  <span class="visually-hidden">Previous</span>
                </button>
                <button
                  class="carousel-control-next"
                  type="button"
                  data-bs-target="#room-carousel"
                  data-bs-slide="next"
                >
                  <span
                    class="carousel-control-next-icon"
                    aria-hidden="true"
                  ></span>
                  <span class="visually-hidden">Next</span>
                </button>
              </div>


              <div class="d-flex align-items-center mb-4">
                <h1 class="mb-0">{{habitacion.id_th.descripcion}} {{habitacion.numero}}</h1>
                <div class="ps-3">

                  <small class="fa fa-star text-primary"></small>
                  {{habitacion.num_star}} Estrellas
                  
                </div>
              </div>
              <div class="d-flex flex-wrap pb-4 m-n1">
                <small class="bg-light rounded py-1 px-3 m-1">
                    <i class="fa fa-bed text-primary me-2"></i>{{habitacion.habitaciones}} camas
                </small>
                <small class="bg-light rounded py-1 px-3 m-1">
                    <i class="fa fa-bath text-primary me-2"></i>{{habitacion.banos}} baños
                </small>
                {% if habitacion.wifi == 's' %}
                <small class="bg-light rounded py-1 px-3 m-1"
                  ><i class="fa fa-wifi text-primary me-2"></i>Wifi</small
                >
                {% endif %}
                {% if habitacion.tv_cable == 's' %}
                <small class="bg-light rounded py-1 px-3 m-1"
                  ><i class="fa fa-tv text-primary me-2"></i>TV</small
                >
                {% endif %}
                {% if habitacion.desayuno == 's' %}
                <small class="bg-light rounded py-1 px-3 m-1"
                  ><i class="fa fa-utensils text-primary me-2"></i>Desayuno</small
                >
                {% endif %}  
              </div>
              <p>
                {{habitacion.descripcion}}
              </p>
              <p class="mb-5">
                
              </p>
              <div class="tab-class wow fadeInUp" data-wow-delay="0.1s">
                <ul
                  class="nav nav-pills d-flex justify-content-between border-bottom mb-4"
                >
                  <li class="nav-item">
                    <a
                      class="d-flex align-items-center py-3 active"
                      data-bs-toggle="pill"
                      href="#tab-1"
                    >
                      <i class="fa fa-eye text-primary me-2"></i>
                      <h6 class="mb-0">Que podemos Hacer</h6>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a
                      class="d-flex align-items-center py-3"
                      data-bs-toggle="pill"
                      href="#tab-2"
                    >
                      <i class="fa fa-dollar text-primary me-2"></i>
                      <h6 class="mb-0">Valor</h6>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a
                      class="d-flex align-items-center py-3"
                      data-bs-toggle="pill"
                      href="#tab-3"
                    >
                      <i class="fa fa-map-marker-alt text-primary me-2"></i>
                      <h6 class="mb-0">Ubicacion</h6>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a
                      class="d-flex align-items-center py-3"
                      data-bs-toggle="pill"
                      href="#tab-4"
                    >
                      <i class="fa fa-star text-primary me-2"></i>
                      <h6 class="mb-0">Comentarios</h6>
                    </a>
                  </li>
                </ul>
                <div class="tab-content">
                  <div id="tab-1" class="tab-pane fade show p-0 active">
                    <p>
                      Ubicada en la zona sur de Chile, Valdivia es un lugar encantador de clima oceánico cuya principal característica es asimilar diversos elementos culturales tanto nativos como exógenos. Con abundante oferta turística, existen muchos lugares gratuitos en Valdivia para conocer y deleitarse facilitando así, su accesibilidad y exploración.

Conocida por su rica historia, impresionante arquitectura, hermosos paisajes y deliciosa gastronomía, Valdivia es un destino turístico cada vez más popular entre los viajeros de todo el mundo.

La ciudad se encuentra en la confluencia de los ríos Calle-Calle, Cau Cau y Valdivia, lo que la convierte en un lugar ideal para explorar y disfrutar de la belleza natural del sur de Chile.

Uno de los principales atractivos turísticos de la ciudad es su arquitectura, componente que refleja una potente fusión cultural. En efecto, la combinación de la cultura española, alemana y de los mapuches ha sido clave para dar vida a sus construcciones y, por ende, para el desarrollo arquitectónico de la ciudad.
                    </p>
                    
                  </div>
                  <div id="tab-2" class="tab-pane fade show p-0">
                    <p>
                      Los valores de la habitacion son estandar durante todo el año,
                    </p>
                    <div class="row g-4">
                      <div
                        class="col-sm-6 d-flex align-items-center justify-content-between"
                      >
                        <span>Valor por Noche:</span>
                        <hr class="flex-grow-1 my-0 mx-3" />
                        <span>${{habitacion.precio_noche}}</span>
                      </div>
                
                    </div>
                  </div>
                  <div id="tab-3" class="tab-pane fade show p-0">
                    <div class="row g-4 mb-4">
                      <div class="col-md-4 d-flex align-items-center">
                        <div
                          class="flex-shrink-0 border rounded p-1 me-3"
                          style="width: 45px; height: 45px"
                        >
                          <div
                            class="w-100 h-100 border rounded d-flex align-items-center justify-content-center"
                          >
                            <i class="fa fa-map-marker-alt text-primary"></i>
                          </div>
                        </div>
                        <span>Gral. Korner 770, 4930680 Villarrica, Araucanía</span>
                      </div>
                      <div class="col-md-4 d-flex align-items-center">
                        <div
                          class="flex-shrink-0 border rounded p-1 me-3"
                          style="width: 45px; height: 45px"
                        >
                          <div
                            class="w-100 h-100 border rounded d-flex align-items-center justify-content-center"
                          >
                            <i class="fa fa-phone-alt text-primary"></i>
                          </div>
                        </div>
                        <span>(45) 241 1833</span>
                      </div>
                      <div class="col-md-4 d-flex align-items-center">
                        <div
                          class="flex-shrink-0 border rounded p-1 me-3"
                          style="width: 45px; height: 45px"
                        >
                          <div
                            class="w-100 h-100 border rounded d-flex align-items-center justify-content-center"
                          >
                            <i class="fa fa-envelope text-primary"></i>
                          </div>
                        </div>
                        <span
                          ><a
                            href="mailto:info@hpr.com"                            
                            >Email Reserva</a
                          ></span
                        >
                      </div>
                    </div>
                    <iframe
                      class="position-relative rounded w-100 h-100"
                      src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d196242.43528422824!2d-73.4069923814072!3d-39.778090581798445!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9615e94f20de4501%3A0x89b7301051537813!2sValdivia%2C%20Los%20R%C3%ADos!5e0!3m2!1ses!2scl!4v1727699936120!5m2!1ses!2scl"
                      frameborder="0"
                      style="min-height: 350px; border: 0"
                      allowfullscreen
                      aria-hidden="false"
                      tabindex="0"
                    ></iframe>
                  </div>
                  <div id="tab-4" class="tab-pane fade show p-0">
                    
                    {% if cantidad %}
                    
                    
                    <div class="mb-4">

                      <h4 class="mb-4">{{cantidad}} Comentarios</h4>

                        {% for com in comentarios  %}
                        
                      <div class="d-flex mb-4">
                        <img
                          src="{% static 'img/user.png' %}"
                          class="img-fluid rounded"
                          style="width: 45px; height: 45px"
                        />
                        <div class="ps-3">
                          <h6>{{com.nombre}} <small class="text-body fw-normal fst-italic"> {{com.fecha_creacion}}</small>
                          </h6>
                          <p class="mb-2">
                            {{com.comentario}}
                          </p>
                          
                        </div>
                      </div>

                    
                        {% endfor %}
                
                    </div>
                    {% endif %}


                    <div class="bg-light p-4 p-md-5">
                      <h4 class="mb-4">Deje una Reseña</h4>
                      <form action="{% url 'DA' habitacion.id_h %}" method="post">
                        {% csrf_token %}
                        <div class="row g-3">
                          <div class="col-12 d-flex align-items-center">
                            <h6 class="mb-0 me-2">Califiqueme:</h6>
                            <div id="halfstarsReview" class="fs-3 me-2"></div>

                            <input
                              type="text"
                              value
                              readonly
                              id="halfstarsInput"
                              class="border-0 bg-transparent"
                              style="width: 30px"
                            />
                          </div>
                          <div class="col-12 col-sm-6">
                          <input
                              type="hidden"
                              class="form-control bg-white border-0"
                              placeholder="Tu Nombre"
                              value="{{habitacion.id_h}}"
                              name="id_h"
                              style="height: 55px"
                            />
                            <input
                              type="text"
                              class="form-control bg-white border-0"
                              placeholder="Tu Nombre"
                              name="nombre"
                              style="height: 55px"
                            />
                          </div>
                          <div class="col-12 col-sm-6">
                            <input
                              type="email"
                              class="form-control bg-white border-0"
                              placeholder="Tu Email"
                              name="email"
                              style="height: 55px"
                            />
                          </div>
                          
                          <div class="col-12">
                            <textarea
                              class="form-control bg-white border-0"
                              rows="5"
                              placeholder="Comentario"
                              name="comentario"
                            ></textarea>
                          </div>
                          <div class="col-12">
                            <button
                              class="btn btn-primary w-100 py-3"
                              type="submit"
                            >
                              Envie su Comentario
                            </button>
                            {{mensaje}}
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>


            <!-- reserva -->
              {% if user.is_authenticated %}
              <div class="col-lg-4">
                <div class="bg-light mb-5 wow fadeInUp" data-wow-delay="0.1s" style="padding: 10px;">
                  <div class="border-bottom text-center text-dark p-3 pt-4 mb-3">
                    <span class="align-top fs-4 lh-base">$</span>
                    <span class="align-middle fs-1 lh-sm fw-bold">{{habitacion.precio_noche}}</span>
                    <span class="align-bottom fs-6 lh-lg">/ Noche</span>
                  </div>
                  <div class="row g-3 p-4 pt-2">
                    <form action="{% url 'RESERVAR' %}" method="post">
                      {% csrf_token %}
                    <div class="col-12" style="padding: 10px;">
                      <div class="date" id="date3" name="date3" data-target-input="nearest">
                        <input type="text" name="fi" class="form-control datetimepicker-input" placeholder="Check in" data-target="#date3" data-toggle="datetimepicker"/>
                      </div>
                    </div>
                    <div class="col-12" style="padding: 10px;">
                      <div class="date" id="date4" name="date4" data-target-input="nearest">
                        <input name="ft" type="text" class="form-control datetimepicker-input" placeholder="Check out" data-target="#date4" data-toggle="datetimepicker" />
                      </div>
                    </div>
                    <div class="col-12" style="padding: 10px;">
                      <select class="form-select" name="cant_personas">
                        <option selected>Adultos</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                      </select>
                    </div>
                    
                    {% if habitacion.activa == "s" %}
                    <div class="col-12" style="padding: 10px;">
                      <input type="hidden" name="id_h" value="{{habitacion.id_h}}">
                      <input type="hidden" name="id_h" value="{{user.username}}">
                      <input type="hidden" name="valor" value="{{habitacion.precio_noche}}">
                      <input type="hidden" name="habitacion" value="{{habitacion.id_h}}">
                      <input type="text" name="email" value="{{usuario}}">
                      <button class="btn btn-primary py-3 w-100" type="submit">Reservar Ahora</button>
                    </div>
                    {% else %}
                      <div class="col-12" style="padding: 10px;">
                      <button class="btn btn-danger py-3 w-100">Ocupada</button>
                    </div>
                    {% endif %}
                    
                  </form>

                  </div>
                </div>


              </div>
              {% else %}
                <div class="col-lg-4">
                <div class="bg-light mb-5 wow fadeInUp" data-wow-delay="0.1s">
                  <div class="border-bottom text-center text-dark p-3 pt-4 mb-3">
                    <span class="align-top fs-4 lh-base">$</span>
                    <span class="align-middle fs-1 lh-sm fw-bold">{{habitacion.precio_noche}}</span>
                    <span class="align-bottom fs-6 lh-lg">/ Noche</span>
                  </div>
                  <div class="row g-3 p-4 pt-2">                    
                    <div class="col-12">
                   
                      <button class="btn btn-primary py-3 w-100" type="button" onclick="ir()">Para Reservar Inicio Sesion</button>
                      <script>
                        function ir(){
                          location.href="{% url 'LO' %}"
                        }
                      </script>
                    </div>

                  </div>
                </div>
              </div>
              {% endif %}
          </div>
        </div>
      </div>

      <div class="container-xxl py-5">
        <div class="container">
          <div class="text-center wow fadeInUp" data-wow-delay="0.1s">
            <h6 class="section-title text-center text-primary text-uppercase">
              Vea Otras Habitaciones
            </h6>
            <h1 class="mb-5">
              Explore la Galeria de 
              <span class="text-primary text-uppercase">Habitaciones</span>
            </h1>
          </div>
          <div class="row g-4">

            <div class="col-12 text-center wow fadeInUp" data-wow-delay="0.9s">
              <a href="{% url 'HA' %}" class="btn btn-primary py-3 px-5">Ver</a>
            </div>
          </div>
        </div>
      </div>

      <div class="container newsletter mt-5 wow fadeIn" data-wow-delay="0.1s">
        <div class="row justify-content-center">
          <div class="col-lg-10 border rounded p-1">
            <div class="border rounded text-center p-1">
                <div class="bg-white rounded text-center p-5">
                            <h4 class="mb-4">Suscribase a nuestras <span class="text-primary text-uppercase">ofertas</span></h4>
                            <div class="position-relative mx-auto" style="max-width: 400px;">
                                <input class="form-control w-100 py-3 ps-4 pe-5" type="text" placeholder="Ingrese su correo electronico">
                                <button type="button" class="btn btn-primary py-2 px-3 position-absolute top-0 end-0 mt-2 me-2">Enviar</button>
                            </div>
                </div>
            </div>
          </div>
        </div>
      </div>
{% endblock contenido %}
